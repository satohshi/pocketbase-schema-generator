{
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"title": "Config",
	"description": "Configuration for pocketbase-schema-generator",
	"type": "object",
	"allOf": [
		{ "$ref": "#/definitions/baseOptions" },
		{
			"type": "object",
			"properties": {
				"$schema": { "type": "string" },
				"tsSchema": {
					"type": "object",
					"description": "Options controlling generation of the TypeScript schema file.",
					"allOf": [
						{ "$ref": "#/definitions/schemaOptions" },
						{
							"type": "object",
							"properties": {
								"includeDocs": {
									"type": "boolean",
									"description": "Whether to include JSDoc comments with field metadata in the generated schema."
								}
							},
							"required": ["includeDocs"]
						}
					]
				},
				"zodSchema": {
					"type": "object",
					"description": "Options controlling generation of the Zod schema file.",
					"allOf": [{ "$ref": "#/definitions/schemaOptions" }]
				}
			},
			"required": ["tsSchema", "zodSchema"]
		}
	],
	"definitions": {
		"baseOptions": {
			"type": "object",
			"description": "Options controlling whether to expose the web schema endpoint",
			"properties": {
				"exposeEndpoint": {
					"type": "boolean",
					"description": "Whether to register the HTTP endpoint that serves the generated schemas."
				},
				"endpointPath": {
					"type": "string",
					"description": "Path at which the schema endpoint will be exposed (e.g. \"/schema\").",
					"pattern": "^/[^\\s]+$"
				},
				"secureEndpoint": {
					"type": "boolean",
					"description": "Whether the schema endpoint should require authentication."
				}
			},
			"required": ["exposeEndpoint"],
			"if": {
				"properties": { "exposeEndpoint": { "const": true } }
			},
			"then": {
				"required": ["endpointPath", "secureEndpoint"]
			}
		},
		"schemaOptions": {
			"type": "object",
			"properties": {
				"generateFile": {
					"type": "boolean",
					"description": "Whether to generate and write the schema file to disk."
				},
				"includeSystemCollections": {
					"type": "boolean",
					"description": "Whether to include system collections like _superusers and _otps when generating the schema."
				},
				"outputPath": {
					"type": "string",
					"description": "File path where the generated schema will be written. Also used for the default filename when downloading from web UI.",
					"minLength": 1
				},
				"banner": {
					"type": "array",
					"description": "Array of strings to insert at the top of the generated schema file. Use this to import custom schema for overrides.",
					"minItems": 1,
					"items": { "type": "string" }
				},
				"overrides": {
					"type": "object",
					"description": "Specify the shape of JSON fields here.",
					"minProperties": 1,
					"additionalProperties": {
						"type": "object",
						"description": "Names of collections with JSON fields.",
						"minProperties": 1,
						"additionalProperties": {
							"type": "string",
							"description": "Name of the JSON field as key, and the shape of JSON as value.",
							"minLength": 1
						}
					}
				}
			},
			"required": ["generateFile", "includeSystemCollections"],
			"if": {
				"properties": { "generateFile": { "const": true } }
			},
			"then": {
				"required": ["outputPath"]
			}
		}
	}
}
